import{g as ve,a as ge,F as R,v as E,r as p,u as be,G as Ce,j as r,s as ke,i as je,b as ae,e as Se,m as Te,h as we,H as ee,J as Le,K as Pe,L as te,M as Re,N as De,O as Ee,Q as ne,R as Fe,S as re,T as Me,A as F,C as oe,D as ze,U as Ve}from"./index-CmZIXnGo.js";import{C as _e,B as G,u as $e,S as Ae,R as Ie,T as Be,a as Ne}from"./usePagination-Ckk7i3KV.js";import{T as M,l as Ue,C as He,j as Oe,G as Ke,P as Ge,E as We,k as D,h as qe}from"./ResourceIcon-Dl-GBr9k.js";import{u as Je}from"./shallow-CVc0jtq0.js";function Qe(e){return ge("MuiLink",e)}const Xe=ve("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),Ye=({theme:e,ownerState:n})=>{const t=n.color,l=R(e,`palette.${t}.main`,!1)||R(e,`palette.${t}`,!1)||n.color,f=R(e,`palette.${t}.mainChannel`)||R(e,`palette.${t}Channel`);return"vars"in e&&f?`rgba(${f} / 0.4)`:E(l,.4)},se={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},Ze=e=>{const{classes:n,component:t,focusVisible:l,underline:f}=e,o={root:["root",`underline${ae(f)}`,t==="button"&&"button",l&&"focusVisible"]};return Se(o,Qe,n)},et=ke(M,{name:"MuiLink",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:t}=e;return[n.root,n[`underline${ae(t.underline)}`],t.component==="button"&&n.button]}})(Te(({theme:e})=>({variants:[{props:{underline:"none"},style:{textDecoration:"none"}},{props:{underline:"hover"},style:{textDecoration:"none","&:hover":{textDecoration:"underline"}}},{props:{underline:"always"},style:{textDecoration:"underline","&:hover":{textDecorationColor:"inherit"}}},{props:({underline:n,ownerState:t})=>n==="always"&&t.color!=="inherit",style:{textDecorationColor:"var(--Link-underlineColor)"}},...Object.entries(e.palette).filter(we()).map(([n])=>({props:{underline:"always",color:n},style:{"--Link-underlineColor":e.vars?`rgba(${e.vars.palette[n].mainChannel} / 0.4)`:E(e.palette[n].main,.4)}})),{props:{underline:"always",color:"textPrimary"},style:{"--Link-underlineColor":e.vars?`rgba(${e.vars.palette.text.primaryChannel} / 0.4)`:E(e.palette.text.primary,.4)}},{props:{underline:"always",color:"textSecondary"},style:{"--Link-underlineColor":e.vars?`rgba(${e.vars.palette.text.secondaryChannel} / 0.4)`:E(e.palette.text.secondary,.4)}},{props:{underline:"always",color:"textDisabled"},style:{"--Link-underlineColor":(e.vars||e).palette.text.disabled}},{props:{component:"button"},style:{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${Xe.focusVisible}`]:{outline:"auto"}}}]}))),tt=p.forwardRef(function(n,t){const l=be({props:n,name:"MuiLink"}),f=Ce(),{className:o,color:i="primary",component:m="a",onBlur:j,onFocus:c,TypographyClasses:b,underline:g="always",variant:u="inherit",sx:d,...x}=l,[z,L]=p.useState(!1),V=v=>{ee(v.target)||L(!1),j&&j(v)},P=v=>{ee(v.target)&&L(!0),c&&c(v)},y={...l,color:i,component:m,focusVisible:z,underline:g,variant:u},h=Ze(y);return r.jsx(et,{color:i,className:je(h.root,o),classes:b,component:m,onBlur:V,onFocus:P,ref:t,ownerState:y,variant:u,...x,sx:[...se[i]===void 0?[{color:i}]:[],...Array.isArray(d)?d:[d]],style:{...x.style,...g==="always"&&i!=="inherit"&&!se[i]&&{"--Link-underlineColor":Ye({theme:f,ownerState:y})}}})}),nt="Error preloading route! ☝️";function rt(e,n){const t=Le(),[l,f]=p.useState(!1),o=p.useRef(!1),i=Pe(n),{activeProps:m=()=>({className:"active"}),inactiveProps:j=()=>({}),activeOptions:c,to:b,preload:g,preloadDelay:u,hashScrollIntoView:d,replace:x,startTransition:z,resetScroll:L,viewTransition:V,children:P,target:y,disabled:h,style:v,className:_,onClick:$,onFocus:A,onMouseEnter:I,onMouseLeave:B,onTouchStart:N,ignoreBlocker:le,...ie}=e,{params:it,search:ct,hash:ut,state:dt,mask:pt,reloadDocument:ft,...W}=ie,q=p.useMemo(()=>{try{return new URL(`${b}`),"external"}catch{}return"internal"},[b]),ce=te({select:s=>s.location.search,structuralSharing:!0}),J=Re({select:s=>{var a;return e.from??((a=s[s.length-1])==null?void 0:a.fullPath)}}),C=p.useMemo(()=>({...e,from:J}),[e,J]),k=p.useMemo(()=>t.buildLocation(C),[t,C,ce]),T=p.useMemo(()=>C.reloadDocument?!1:g??t.options.defaultPreload,[t.options.defaultPreload,g,C.reloadDocument]),ue=u??t.options.defaultPreloadDelay??0,U=te({select:s=>{if(c!=null&&c.exact){if(!Fe(s.location.pathname,k.pathname,t.basepath))return!1}else{const a=re(s.location.pathname,t.basepath).split("/");if(!re(k.pathname,t.basepath).split("/").every((xe,ye)=>xe===a[ye]))return!1}return((c==null?void 0:c.includeSearch)??!0)&&!Me(s.location.search,k.search,{partial:!(c!=null&&c.exact),ignoreUndefined:!(c!=null&&c.explicitUndefined)})?!1:c!=null&&c.includeHash?s.location.hash===k.hash:!0}}),S=p.useCallback(()=>{t.preloadRoute(C).catch(s=>{console.warn(s),console.warn(nt)})},[C,t]),de=p.useCallback(s=>{s!=null&&s.isIntersecting&&S()},[S]);if(De(i,de,{rootMargin:"100px"},{disabled:!!h||T!=="viewport"}),Ee(()=>{o.current||!h&&T==="render"&&(S(),o.current=!0)},[h,S,T]),q==="external")return{...W,ref:i,type:q,href:b,...P&&{children:P},...y&&{target:y},...h&&{disabled:h},...v&&{style:v},..._&&{className:_},...$&&{onClick:$},...A&&{onFocus:A},...I&&{onMouseEnter:I},...B&&{onMouseLeave:B},...N&&{onTouchStart:N}};const pe=s=>{if(!h&&!at(s)&&!s.defaultPrevented&&(!y||y==="_self")&&s.button===0){s.preventDefault(),Ue.flushSync(()=>{f(!0)});const a=t.subscribe("onResolved",()=>{a(),f(!1)});return t.navigate({...C,replace:x,resetScroll:L,hashScrollIntoView:d,startTransition:z,viewTransition:V,ignoreBlocker:le})}},Q=s=>{h||T&&S()},fe=Q,he=s=>{if(h)return;const a=s.target||{};if(T){if(a.preloadTimeout)return;a.preloadTimeout=setTimeout(()=>{a.preloadTimeout=null,S()},ue)}},me=s=>{if(h)return;const a=s.target||{};a.preloadTimeout&&(clearTimeout(a.preloadTimeout),a.preloadTimeout=null)},w=s=>a=>{var K;(K=a.persist)==null||K.call(a),s.filter(Boolean).forEach(Z=>{a.defaultPrevented||Z(a)})},H=U?ne(m,{})??{}:{},O=U?{}:ne(j,{}),X=[_,H.className,O.className].filter(Boolean).join(" "),Y={...v,...H.style,...O.style};return{...W,...H,...O,href:h?void 0:k.maskedLocation?t.history.createHref(k.maskedLocation.href):t.history.createHref(k.href),ref:i,onClick:w([$,pe]),onFocus:w([A,Q]),onMouseEnter:w([I,he]),onMouseLeave:w([B,me]),onTouchStart:w([N,fe]),disabled:!!h,target:y,...Object.keys(Y).length&&{style:Y},...X&&{className:X},...h&&{role:"link","aria-disabled":!0},...U&&{"data-status":"active","aria-current":"page"},...l&&{"data-transitioning":"transitioning"}}}const st=p.forwardRef((e,n)=>{const{_asChild:t,...l}=e,{type:f,ref:o,...i}=rt(l,n),m=typeof l.children=="function"?l.children({isActive:i["data-status"]==="active"}):l.children;return typeof t>"u"&&delete i.disabled,p.createElement(t||"a",{...i,ref:o},m)});function at(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function ot({trading:e,...n}){const t=F(o=>o.remove),l=F(o=>o.buy),f=F(o=>o.sell);return r.jsxs(He,{variant:"elevation",sx:{display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[r.jsxs(Oe,{children:[r.jsxs(M,{variant:"h5",fontSize:{xs:20,sm:24},component:"div",display:"flex",alignItems:"center",gap:1,lineHeight:1,children:[r.jsx(Ke,{name:n.icon,category:"resources",sx:{color:o=>o.palette.text.secondary}}),n.name]}),r.jsxs(oe,{sx:{color:"text.secondary",mb:1,mt:.25},display:"flex",gap:1,children:[r.jsx(tt,{title:n.source,color:"textSecondary",fontSize:"inherit",component:st,to:n.type.includes("Существо")?"/creatures":"/plants",search:{c:n.source},children:n.type}),r.jsx("span",{children:n.attribute}),r.jsx("span",{children:n.rank})]}),r.jsx(M,{sx:{color:"text.secondary",fontSize:14,mb:.25},children:n.effect}),r.jsx(M,{variant:"body2",children:n.description})]}),r.jsx(_e,{children:e?r.jsx(G,{size:"small",variant:"text",onClick:()=>t(n.name),children:"Снять с обмена"}):r.jsxs(r.Fragment,{children:[r.jsx(G,{size:"small",onClick:()=>f(n),children:"Продать"}),r.jsx(G,{size:"small",onClick:()=>l(n),children:"Купить"})]})})]})}const lt=p.memo(function(){const{status:n,data:t,error:l}=ze(),f=F(Je(u=>Object.fromEntries([...u.buying.map(d=>d.name),...u.selling.map(d=>d.name)].map(d=>[d,!0])))),[o,i]=Ve("",500),[m,j]=p.useState([]),c=p.useMemo(()=>{const u=o.trim().toLowerCase();let d=(t==null?void 0:t.items)||[];return m.length&&(d=d.filter(x=>m.includes(x.rank))),u?d.filter(x=>[x.name,x.type,x.attribute].join(";").toLowerCase().includes(u)):d},[t,m,o]),{paginate:b,...g}=$e(c.length,9);return n==="pending"?r.jsx(Ge,{}):n==="error"?r.jsx(We,{message:l.message}):r.jsxs(r.Fragment,{children:[r.jsxs(D,{container:!0,spacing:{xs:1,sm:1,md:2},children:[r.jsx(D,{size:12,children:r.jsx(qe,{placeholder:"Поиск",fullWidth:!0,startAdornment:r.jsx(Ae,{sx:{color:"action.active",mr:1,my:.5}}),onChange:u=>i(u.target.value)})}),r.jsx(D,{display:"flex",size:{sm:12,md:6},justifyContent:"flex-start",children:r.jsx(Ie,{ranks:m,setRanks:j})}),r.jsx(D,{size:{xs:12,sm:12,md:6},children:r.jsx(Be,{...g})})]}),r.jsx(oe,{sx:{width:"100%",display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(min(350px, 100%), 1fr))",gap:2,pb:2},children:b(c).map(u=>r.jsx(ot,{trading:f[u.name],...u},u.name))}),r.jsx(Ne,{...g})]})}),vt=lt;export{vt as component};
